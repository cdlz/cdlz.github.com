<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

	<title>解析pcap文件及读取实现源码 | Only For Sunshine~</title>
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有文章" href="../../feed/index.html" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有评论" href="../../comments/feed/index.html" />
	<link rel="pingback" href="../../xmlrpc.php" />

	<!-- style START -->
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/style.css" type="text/css" media="screen" />
			<link rel="stylesheet" href="../../wp-content/themes/elegant-box/chinese.css" type="text/css" media="screen" />
		<!--[if IE]>
		<link rel="stylesheet" href="http://imzc.net/wp-content/themes/elegant-box/ie.css" type="text/css" media="screen" />
	<![endif]-->

	<!-- default style -->
			<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/blue/default.css" type="text/css" media="screen" title="blue" />
		<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/blue/global.css" type="text/css" media="screen" />
	
	<!-- others styles -->
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/green/default.css" type="text/css" media="screen" title="green" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/green/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/purple/default.css" type="text/css" media="screen" title="purple" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/purple/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/brown/default.css" type="text/css" media="screen" title="brown" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/brown/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/white/default.css" type="text/css" media="screen" title="white" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/white/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/black/default.css" type="text/css" media="screen" title="black" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/black/global.css" type="text/css" media="screen" />
	<!-- style END -->

	<!-- javascript START -->
			<script type="text/javascript" src="../../wp-content/themes/elegant-box/js/styleswitcher.js"></script>
		<script type="text/javascript" src="../../wp-content/themes/elegant-box/js/base.js"></script>
	<script type="text/javascript" src="../../wp-content/themes/elegant-box/js/menu.js"></script>
	<!-- javascript END -->

		<link rel="alternate" type="application/rss+xml" title="Only For Sunshine~ &raquo; 解析pcap文件及读取实现源码 评论 Feed" href="feed/index.html" />
<link rel='stylesheet' id='jquery.slimbox-css'  href='../../wp-content/plugins/slimbox/stylesheets/jquery.slimbox.css?ver=2.03' type='text/css' media='all' />
<link rel='stylesheet' id='wp-pagenavi-css'  href='../../wp-content/themes/elegant-box/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<script type="text/javascript">
var duoshuoQuery = {"short_name":"imzc","sso":{"login":"http:\/\/imzc.net\/wp-login.php?action=duoshuo_login","logout":"http:\/\/imzc.net\/wp-login.php?action=logout&_wpnonce=9cdb31637c"},"remote_auth":"W10= 92c18f7cd17bb51ec396ff881b47562ee03f7759 1344775335"};
duoshuoQuery.sso.login += '&redirect_to=' + encodeURIComponent(window.location.href);
duoshuoQuery.sso.logout += '&redirect_to=' + encodeURIComponent(window.location.href);
</script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery.js?ver=1.7.2'></script>
<script type='text/javascript' src='../../wp-content/plugins/slimbox/javascript/jquery.slimbox.js?ver=2.03'></script>
<script type='text/javascript' src='../../wp-includes/js/json2.js?ver=2011-02-23'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var live_blogging = {"ajaxurl":"http:\/\/imzc.net\/wp-admin\/admin-ajax.php","update_effect":"top"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/live-blogging/live-blogging.js?ver=3.4.1'></script>
<script type='text/javascript' src='../../wp-includes/js/comment-reply.js?ver=3.4.1'></script>
<script type='text/javascript' src='http://static.duoshuo.com/embed.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Windows获取开机时间' href='../179/index.html' />
<link rel='next' title='plist简单的读写方法' href='../188/index.html' />
<meta name="generator" content="WordPress 3.4.1" />
<link rel='shortlink' href='http://wp.me/p19waf-2V' />

<!-- All in One SEO Pack 1.6.14.6 by Michael Torbert of Semper Fi Web Design[343,414] -->
<meta name="description" content="解析pcap文件及读取实现源码,c,c++" />
<meta name="keywords" content="pcap,parse pcap" />
<link rel="canonical" href="index.html" />
<!-- /all in one seo pack -->
<script type="text/javascript">
	jQuery(document).ready(function($){	
	    var select = $('a[href$=".bmp"],a[href$=".gif"],a[href$=".jpg"],a[href$=".jpeg"], a[href$=".png"],a[href$=".BMP"],a[href$=".GIF"],a[href$=".JPG"],a[href$=".JPEG"],a[href$=".PNG"]');
		select.slimbox();
	});
</script>

<link rel="stylesheet" href="../../wp-content/themes/elegant-box/wp-syntax.css" type="text/css" media="screen" />
</head>


<body>
	<!-- header START -->
	<div id="header">
		<div class="inner">
			<div class="content">
				<div class="caption">
					<h1 id="title"><a href="../../index.html" title="-More Thinking,And Then Just do it~~~">Only For Sunshine~</a></h1>
					<div id="tagline">-More Thinking,And Then Just do it~~~</div>
				</div>

				<!-- search box -->
									<form action="http://www.google.com/cse" id="search_box" method="get">
						<div id="searchbox">
							<input type="text" id="searchtxt" class="textfield" name="q" size="24" />
							<input type="hidden" name="cx" value="007838838681523399853:u4canb53vle" />
							<input type="hidden" name="ie" value="UTF-8" />
						</div>
					</form>
				<script type="text/javascript">
//<![CDATA[
	var searchbox = document.getElementById("searchbox");
	var searchtxt = document.getElementById("searchtxt");
	var tiptext = "请输入关键字...";
	if(searchtxt.value == "" || searchtxt.value == tiptext) {
		searchtxt.className += " searchtip";
		searchtxt.value = tiptext;
	}
	searchtxt.onfocus = function(e) {
		if(searchtxt.value == tiptext) {
			searchtxt.value = "";
			searchtxt.className = searchtxt.className.replace(" searchtip", "");
		}
	}
	searchtxt.onblur = function(e) {
		if(searchtxt.value == "") {
			searchtxt.className += " searchtip";
			searchtxt.value = tiptext;
		}
	}
//]]>
</script>

				<!-- navigation START -->
				<ul id="navigation">

					<li class="page_item"><a href="../../index.html">首页</a></li>
					<li class="page_item page-item-260"><a href="../../ios/index.html">IOS_PROJ</a></li>
<li class="page_item page-item-164"><a href="../../wp_otp/index.html">WP_OTP</a></li>
<li class="page_item page-item-180"><a href="../../vps-recommended/index.html">vps推荐</a></li>
<li class="page_item page-item-139"><a href="../../mysites/index.html">我的站点</a></li>
<li class="page_item page-item-2"><a href="../../aboutme/index.html">关于</a></li>
					<li id="subscribe">
						<a rel="external nofollow" title="订阅这个博客的文章" id="feed" href="../../feed/index.html"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="RSS 订阅" /></a>
													<ul>
								<li class="first"><a rel="external nofollow" title="订阅到有道" href="http://reader.youdao.com/b.do?url=http://imzc.net/feed/"> 有道</a></li>
								<li><a rel="external nofollow" title="订阅到鲜果" href="http://www.xianguo.com/subscribe.php?url=http://imzc.net/feed/"> 鲜果</a></li>
								<li><a rel="external nofollow" title="订阅到抓虾" href="http://www.zhuaxia.com/add_channel.php?url=http://imzc.net/feed/"> 抓虾</a></li>
								<li><a rel="external nofollow" title="订阅到 Google" href="http://fusion.google.com/add?feedurl=http://imzc.net/feed/">  Google</a></li>
								<li><a rel="external nofollow" title="订阅到 My Yahoo!" href="http://add.my.yahoo.com/rss?url=http://imzc.net/feed/">  My Yahoo!</a></li>
								<li><a rel="external nofollow" title="订阅到 newsgator" href="http://www.newsgator.com/ngs/subscriber/subfext.aspx?url=http://imzc.net/feed/">  newsgator</a></li>
								<li><a rel="external nofollow" title="订阅到 Bloglines" href="http://www.bloglines.com/sub/http://imzc.net/feed/">  Bloglines</a></li>
								<li><a rel="external nofollow" title="订阅到 哪吒" href="http://inezha.com/add?url=http://imzc.net/feed/">  哪吒</a></li>
							</ul>
											</li>

				</ul>
				<!-- navigation END -->

			</div>
		</div>
	</div>
	<!-- header END -->

	<div id="container">
		<div id="content">
			<div id="main">

		
			<div class="post">
				<div class="title">
					<h2>解析pcap文件及读取实现源码</h2>
					<div class="fixed"></div>
				</div>

				<div class="info">
					
					<span>2012年1月25日</span>
											<span> | 分类: <a href="../category/c_cplusplus/index.html" title="查看 C/C++ 中的全部文章" rel="category tag">C/C++</a></span>
																<span> | 标签: <a href="../tag/pcap/index.html" rel="tag">pcap</a></span>
					
					<div class="fixed"></div>
				</div>

				<div class="content">
<div style=”padding:3px 0″>
<script type="text/javascript"><!--
google_ad_client = "pub-7220882232307827";
/* blog_468x15, Created @09-2-19 */
google_ad_slot = "1127450986";
google_ad_width = 468;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<br />	
					<p>下面pcap文件格式介绍是在<a href="http://blog.csdn.net/in7deforever/article/details/6460595" target="_blank">网上转的</a>,根据理解，写了个程序来进行解析pcap文件，后续再实现合并pcap功能(wireshark已经自带命令行合并pcap文件工具，在这里只是为了分析pcap文件和学习)。<br />
==========================<br />
默认的*.pcap文件保存格式。</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/ALEKS86/1%29%20Pcap%E6%96%87%E4%BB%B6%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84%E5%92%8CPcap%E6%96%87%E4%BB%B6%E5%A4%B4%E7%BB%93%E6%9E%84.gif" alt="" align="textTop" data-ke-src="http://p.blog.csdn.net/images/p_blog_csdn_net/ALEKS86/1%29%20Pcap%E6%96%87%E4%BB%B6%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84%E5%92%8CPcap%E6%96%87%E4%BB%B6%E5%A4%B4%E7%BB%93%E6%9E%84.gif" /></p>
<p>Pcap文件头24B各字段说明：</p>
<div>Magic：4B：0x1A 2B 3C 4D:用来标示文件的开始</div>
<div>Major：2B，0&#215;02 00:当前文件主要的版本号</div>
<div>Minor：2B，0&#215;04 00当前文件次要的版本号</div>
<div>ThisZone：4B当地的标准时间；全零</div>
<div>SigFigs：4B时间戳的精度；全零</div>
<div>SnapLen：4B最大的存储长度</div>
<div>LinkType：4B链路类型</div>
<div>常用类型：</div>
<div>0            BSD loopback devices, except for later OpenBSD<br />
1            Ethernet, and Linux loopback devices<br />
6            802.5 Token Ring<br />
7            ARCnet<br />
8            SLIP<br />
9            PPP<br />
10           FDDI<br />
100         LLC/SNAP-encapsulated ATM<br />
101         &#8220;raw IP&#8221;, with no link<br />
102         BSD/OS SLIP<br />
103         BSD/OS PPP<br />
104         Cisco HDLC<br />
105         802.11<br />
108         later OpenBSD loopback devices (with the AF_value in network byte order)<br />
113         special Linux &#8220;cooked&#8221; capture<br />
114         LocalTalk</div>
<div></div>
<div><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/ALEKS86/2%EF%BC%89Packet%20%E5%8C%85%E5%A4%B4%EF%BC%8816B%EF%BC%89%E5%92%8CPacket%E6%95%B0%E6%8D%AE%E7%BB%84%E6%88%90.gif" alt="" align="textTop" data-ke-src="http://p.blog.csdn.net/images/p_blog_csdn_net/ALEKS86/2%EF%BC%89Packet%20%E5%8C%85%E5%A4%B4%EF%BC%8816B%EF%BC%89%E5%92%8CPacket%E6%95%B0%E6%8D%AE%E7%BB%84%E6%88%90.gif" /></div>
<div><strong>Packet </strong><strong>包头和Packet</strong><strong>数据组成</strong></div>
<div>字段说明：</div>
<div>Timestamp：时间戳高位，精确到seconds</div>
<div>Timestamp：时间戳低位，精确到microseconds</div>
<div>Caplen：当前数据区的长度，即抓取到的数据帧长度，由此可以得到下一个数据帧的位置。</div>
<div>Len：离线数据长度<strong>：</strong>网络中实际数据帧的长度，一般不大于caplen，多数情况下和Caplen数值相等。</div>
<div><strong>Packet </strong><strong>数据</strong>： 即 Packet（通常就是链路层的数据帧）具体内容，长度就是Caplen，这个长度的后面，就是当前PCAP文件中存放的下一个Packet数据包，也就 是说：PCAP文件里面并没有规定捕获的Packet数据包之间有什么间隔字符串，下一组数据在文件中的起始位置。我们需要靠第一个Packet包确定。 最后，Packet数据部分的格式其实就是标准的网路协议格式了可以任何网络教材上找得到。</div>
<div>===========================</div>
<div>我的实现：</div>
<div>

<div class="wp_syntax"><table><tr><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre></td><td class="code"><pre class="c" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//</span>
<span style="color: #666666; font-style: italic;">//  pcap.h</span>
<span style="color: #666666; font-style: italic;">//  pcaptest</span>
<span style="color: #666666; font-style: italic;">//</span>
<span style="color: #666666; font-style: italic;">//  Created by zc on 12-1-24.</span>
<span style="color: #666666; font-style: italic;">//  Copyright 2012年 __MyCompanyName__. All rights reserved.</span>
<span style="color: #666666; font-style: italic;">//</span>
&nbsp;
<span style="color: #339933;">#ifndef pcaptest_pcap_h</span>
<span style="color: #339933;">#define pcaptest_pcap_h</span>
&nbsp;
<span style="color: #993333;">typedef</span> <span style="color: #993333;">unsigned</span> <span style="color: #993333;">int</span>  bpf_u_int32<span style="color: #339933;">;</span>
<span style="color: #993333;">typedef</span> <span style="color: #993333;">unsigned</span> <span style="color: #993333;">short</span>  u_short<span style="color: #339933;">;</span>
<span style="color: #993333;">typedef</span> <span style="color: #993333;">int</span> bpf_int32<span style="color: #339933;">;</span>
&nbsp;
<span style="color: #808080; font-style: italic;">/*
 Pcap文件头24B各字段说明：
 Magic：4B：0x1A 2B 3C 4D:用来标示文件的开始
 Major：2B，0x02 00:当前文件主要的版本号     
 Minor：2B，0x04 00当前文件次要的版本号
 ThisZone：4B当地的标准时间；全零
 SigFigs：4B时间戳的精度；全零
 SnapLen：4B最大的存储长度    
 LinkType：4B链路类型
 常用类型：
 　0            BSD loopback devices, except for later OpenBSD
 1            Ethernet, and Linux loopback devices
 6            802.5 Token Ring
 7            ARCnet
 8            SLIP
 9            PPP
 */</span>
<span style="color: #993333;">typedef</span> <span style="color: #993333;">struct</span> pcap_file_header <span style="color: #009900;">&#123;</span>
	bpf_u_int32 magic<span style="color: #339933;">;</span>
	u_short version_major<span style="color: #339933;">;</span>
	u_short version_minor<span style="color: #339933;">;</span>
	bpf_int32 thiszone<span style="color: #339933;">;</span>    
	bpf_u_int32 sigfigs<span style="color: #339933;">;</span>   
	bpf_u_int32 snaplen<span style="color: #339933;">;</span>   
	bpf_u_int32 linktype<span style="color: #339933;">;</span>  
<span style="color: #009900;">&#125;</span>pcap_file_header<span style="color: #339933;">;</span>
&nbsp;
<span style="color: #808080; font-style: italic;">/*
 Packet 包头和Packet数据组成
 字段说明：
 Timestamp：时间戳高位，精确到seconds     
 Timestamp：时间戳低位，精确到microseconds
 Caplen：当前数据区的长度，即抓取到的数据帧长度，由此可以得到下一个数据帧的位置。
 Len：离线数据长度：网络中实际数据帧的长度，一般不大于caplen，多数情况下和Caplen数值相等。
 Packet 数据：即 Packet（通常就是链路层的数据帧）具体内容，长度就是Caplen，这个长度的后面，就是当前PCAP文件中存放的下一个Packet数据包，也就 是说：PCAP文件里面并没有规定捕获的Packet数据包之间有什么间隔字符串，下一组数据在文件中的起始位置。我们需要靠第一个Packet包确定。
 */</span>
&nbsp;
<span style="color: #993333;">typedef</span> <span style="color: #993333;">struct</span>  timestamp<span style="color: #009900;">&#123;</span>
	bpf_u_int32 timestamp_s<span style="color: #339933;">;</span>
	bpf_u_int32 timestamp_ms<span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span>timestamp<span style="color: #339933;">;</span>
&nbsp;
<span style="color: #993333;">typedef</span> <span style="color: #993333;">struct</span> pcap_header<span style="color: #009900;">&#123;</span>
	timestamp ts<span style="color: #339933;">;</span>
	bpf_u_int32 capture_len<span style="color: #339933;">;</span>
	bpf_u_int32 len<span style="color: #339933;">;</span>
&nbsp;
<span style="color: #009900;">&#125;</span>pcap_header<span style="color: #339933;">;</span>
&nbsp;
&nbsp;
<span style="color: #993333;">void</span> prinfPcapFileHeader<span style="color: #009900;">&#40;</span>pcap_file_header <span style="color: #339933;">*</span>pfh<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #993333;">void</span> printfPcapHeader<span style="color: #009900;">&#40;</span>pcap_header <span style="color: #339933;">*</span>ph<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #993333;">void</span> printPcap<span style="color: #009900;">&#40;</span><span style="color: #993333;">void</span> <span style="color: #339933;">*</span> data<span style="color: #339933;">,</span>size_t size<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #339933;">#endif</span></pre></td></tr></table></div>


<div class="wp_syntax"><table><tr><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
</pre></td><td class="code"><pre class="c" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//</span>
<span style="color: #666666; font-style: italic;">//  pcap.c</span>
<span style="color: #666666; font-style: italic;">//  pcaptest</span>
<span style="color: #666666; font-style: italic;">//</span>
<span style="color: #666666; font-style: italic;">//  Created by zc on 12-1-24.</span>
<span style="color: #666666; font-style: italic;">//  Copyright 2012年 __MyCompanyName__. All rights reserved.</span>
<span style="color: #666666; font-style: italic;">//</span>
&nbsp;
<span style="color: #339933;">#include &lt;stdio.h&gt;</span>
<span style="color: #339933;">#include &quot;pcap.h&quot;</span>
&nbsp;
<span style="color: #993333;">void</span> prinfPcapFileHeader<span style="color: #009900;">&#40;</span>pcap_file_header <span style="color: #339933;">*</span>pfh<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>pfh<span style="color: #339933;">==</span>NULL<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		<span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span>
	<span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;=====================<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;magic:0x%0x<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;version_major:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;version_minor:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;thiszone:%d<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;sigfigs:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;snaplen:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;linktype:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;=====================<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span>
		   pfh<span style="color: #339933;">-&gt;</span>magic<span style="color: #339933;">,</span>
		   pfh<span style="color: #339933;">-&gt;</span>version_major<span style="color: #339933;">,</span>
		   pfh<span style="color: #339933;">-&gt;</span>version_minor<span style="color: #339933;">,</span>
		   pfh<span style="color: #339933;">-&gt;</span>thiszone<span style="color: #339933;">,</span>
		   pfh<span style="color: #339933;">-&gt;</span>sigfigs<span style="color: #339933;">,</span>
		   pfh<span style="color: #339933;">-&gt;</span>snaplen<span style="color: #339933;">,</span>
		   pfh<span style="color: #339933;">-&gt;</span>linktype<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> printfPcapHeader<span style="color: #009900;">&#40;</span>pcap_header <span style="color: #339933;">*</span>ph<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>ph<span style="color: #339933;">==</span>NULL<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		<span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span>
	<span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;=====================<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;ts.timestamp_s:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;ts.timestamp_ms:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;capture_len:%u<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;len:%d<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>
		   <span style="color: #ff0000;">&quot;=====================<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span>
		   ph<span style="color: #339933;">-&gt;</span>ts.<span style="color: #202020;">timestamp_s</span><span style="color: #339933;">,</span>
		   ph<span style="color: #339933;">-&gt;</span>ts.<span style="color: #202020;">timestamp_ms</span><span style="color: #339933;">,</span>
		   ph<span style="color: #339933;">-&gt;</span>capture_len<span style="color: #339933;">,</span>
		   ph<span style="color: #339933;">-&gt;</span>len<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
&nbsp;
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> printPcap<span style="color: #009900;">&#40;</span><span style="color: #993333;">void</span> <span style="color: #339933;">*</span> data<span style="color: #339933;">,</span>size_t size<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
	<span style="color: #993333;">unsigned</span>  <span style="color: #993333;">short</span> iPos <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span>
	<span style="color: #666666; font-style: italic;">//int * p = (int *)data;</span>
	<span style="color: #666666; font-style: italic;">//unsigned short* p = (unsigned short *)data;</span>
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>data<span style="color: #339933;">==</span>NULL<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		<span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span>
&nbsp;
	<span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>==data:0x%x,len:%lu=========&quot;</span><span style="color: #339933;">,</span>data<span style="color: #339933;">,</span>size<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
	<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span>iPos<span style="color: #339933;">=</span><span style="color: #0000dd;">0</span><span style="color: #339933;">;</span> iPos <span style="color: #339933;">&lt;</span> size<span style="color: #339933;">/</span><span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">unsigned</span> <span style="color: #993333;">short</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> iPos<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		<span style="color: #666666; font-style: italic;">//printf(&quot; %x &quot;,(int)( * (p+iPos) ));</span>
		<span style="color: #666666; font-style: italic;">//unsigned short a = ntohs(p[iPos]);</span>
&nbsp;
		<span style="color: #993333;">unsigned</span> <span style="color: #993333;">short</span> a <span style="color: #339933;">=</span> ntohs<span style="color: #009900;">&#40;</span> <span style="color: #339933;">*</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">unsigned</span> <span style="color: #993333;">short</span> <span style="color: #339933;">*</span><span style="color: #009900;">&#41;</span>data <span style="color: #339933;">+</span> iPos <span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>iPos<span style="color: #339933;">%</span><span style="color:#800080;">8</span><span style="color: #339933;">==</span><span style="color: #0000dd;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>iPos<span style="color: #339933;">%</span><span style="color:#800080;">4</span><span style="color: #339933;">==</span><span style="color: #0000dd;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot; &quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
		<span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;%04x&quot;</span><span style="color: #339933;">,</span>a<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
&nbsp;
	<span style="color: #009900;">&#125;</span>
	<span style="color: #808080; font-style: italic;">/*
	 for (iPos=0; iPos &lt;= size/sizeof(int); iPos++) {
		//printf(&quot; %x &quot;,(int)( * (p+iPos) ));
		int a = ntohl(p[iPos]);
&nbsp;
		//int a = ntohl( *((int *)data + iPos ) );
		if (iPos %4==0) printf(&quot;\n&quot;);
&nbsp;
		printf(&quot;%08x &quot;,a);
&nbsp;
&nbsp;
	}
	 */</span>
	<span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>============<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre></td></tr></table></div>


<div class="wp_syntax"><table><tr><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
</pre></td><td class="code"><pre class="c" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//</span>
<span style="color: #666666; font-style: italic;">//  main.c</span>
<span style="color: #666666; font-style: italic;">//  pcaptest</span>
<span style="color: #666666; font-style: italic;">//</span>
<span style="color: #666666; font-style: italic;">//  Created by zc on 12-1-24.</span>
<span style="color: #666666; font-style: italic;">//  Copyright 2012年 __MyCompanyName__. All rights reserved.</span>
<span style="color: #666666; font-style: italic;">//</span>
&nbsp;
<span style="color: #339933;">#include &lt;stdio.h&gt;</span>
<span style="color: #339933;">#include &lt;arpa/inet.h&gt;</span>
<span style="color: #339933;">#include &quot;pcap.h&quot;</span>
&nbsp;
<span style="color: #339933;">#define PCAP_FILE &quot;ping.pcap&quot;</span>
<span style="color: #339933;">#define MAX_ETH_FRAME 1514</span>
<span style="color: #339933;">#define ERROR_FILE_OPEN_FAILED -1</span>
<span style="color: #339933;">#define ERROR_MEM_ALLOC_FAILED -2</span>
<span style="color: #339933;">#define ERROR_PCAP_PARSE_FAILED -3</span>
&nbsp;
&nbsp;
<span style="color: #993333;">int</span> main <span style="color: #009900;">&#40;</span><span style="color: #993333;">int</span> argc<span style="color: #339933;">,</span> <span style="color: #993333;">const</span> <span style="color: #993333;">char</span> <span style="color: #339933;">*</span> argv<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#123;</span>
&nbsp;
	<span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;sizeof:int %lu,unsigned int %lu,char %lu,unsigned char %lu,short:%lu,unsigned short:%lu<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span>
		    <span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">int</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">unsigned</span> <span style="color: #993333;">int</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">char</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">unsigned</span> <span style="color: #993333;">char</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">short</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">unsigned</span> <span style="color: #993333;">short</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
	pcap_file_header  pfh<span style="color: #339933;">;</span>
	pcap_header  ph<span style="color: #339933;">;</span>
	<span style="color: #993333;">int</span> count<span style="color: #339933;">=</span><span style="color: #0000dd;">0</span><span style="color: #339933;">;</span>
	<span style="color: #993333;">void</span> <span style="color: #339933;">*</span> buff <span style="color: #339933;">=</span> NULL<span style="color: #339933;">;</span>
	<span style="color: #993333;">int</span> readSize<span style="color: #339933;">=</span><span style="color: #0000dd;">0</span><span style="color: #339933;">;</span>
	<span style="color: #993333;">int</span> ret <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span>
&nbsp;
	FILE <span style="color: #339933;">*</span>fp <span style="color: #339933;">=</span> fopen<span style="color: #009900;">&#40;</span>PCAP_FILE<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;rw&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>fp<span style="color: #339933;">==</span>NULL<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		fprintf<span style="color: #009900;">&#40;</span>stderr<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;Open file %s error.&quot;</span><span style="color: #339933;">,</span>PCAP_FILE<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		ret <span style="color: #339933;">=</span> ERROR_FILE_OPEN_FAILED<span style="color: #339933;">;</span>
		<span style="color: #b1b100;">goto</span> ERROR<span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span>
&nbsp;
	fread<span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>pfh<span style="color: #339933;">,</span> <span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span>pcap_file_header<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">,</span> fp<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>	
	prinfPcapFileHeader<span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>pfh<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
	<span style="color: #666666; font-style: italic;">//fseek(fp, 0, sizeof(pcap_file_header));</span>
&nbsp;
	buff <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #993333;">void</span> <span style="color: #339933;">*</span><span style="color: #009900;">&#41;</span>malloc<span style="color: #009900;">&#40;</span>MAX_ETH_FRAME<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
	<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span>count<span style="color: #339933;">=</span><span style="color: #0000dd;">1</span><span style="color: #339933;">;</span> <span style="color: #339933;">;</span> count<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		memset<span style="color: #009900;">&#40;</span>buff<span style="color: #339933;">,</span><span style="color: #0000dd;">0</span><span style="color: #339933;">,</span>MAX_ETH_FRAME<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #666666; font-style: italic;">//read pcap header to get a packet</span>
		<span style="color: #666666; font-style: italic;">//get only a pcap head count .</span>
		readSize<span style="color: #339933;">=</span>fread<span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>ph<span style="color: #339933;">,</span> <span style="color: #993333;">sizeof</span><span style="color: #009900;">&#40;</span>pcap_header<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">,</span> fp<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>readSize<span style="color: #339933;">&lt;=</span><span style="color: #0000dd;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
			<span style="color: #000000; font-weight: bold;">break</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span>
		printfPcapHeader<span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>ph<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
&nbsp;
		<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>buff<span style="color: #339933;">==</span>NULL<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
			fprintf<span style="color: #009900;">&#40;</span>stderr<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;malloc memory failed.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			ret <span style="color: #339933;">=</span> ERROR_MEM_ALLOC_FAILED<span style="color: #339933;">;</span>
			<span style="color: #b1b100;">goto</span> ERROR<span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span>
&nbsp;
		<span style="color: #666666; font-style: italic;">//get a packet contents.</span>
		<span style="color: #666666; font-style: italic;">//read ph.capture_len bytes.</span>
		readSize<span style="color: #339933;">=</span>fread<span style="color: #009900;">&#40;</span>buff<span style="color: #339933;">,</span><span style="color: #0000dd;">1</span><span style="color: #339933;">,</span>ph.<span style="color: #202020;">capture_len</span><span style="color: #339933;">,</span> fp<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>readSize <span style="color: #339933;">!=</span> ph.<span style="color: #202020;">capture_len</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
			free<span style="color: #009900;">&#40;</span>buff<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			fprintf<span style="color: #009900;">&#40;</span>stderr<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;pcap file parse error.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			ret <span style="color: #339933;">=</span> ERROR_PCAP_PARSE_FAILED<span style="color: #339933;">;</span>
			<span style="color: #b1b100;">goto</span> ERROR<span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span>
		printPcap<span style="color: #009900;">&#40;</span>buff<span style="color: #339933;">,</span> ph.<span style="color: #202020;">capture_len</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
&nbsp;
		<span style="color: #000066;">printf</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;===count:%d,readSize:%d===<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span>count<span style="color: #339933;">,</span>readSize<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
		<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>feof<span style="color: #009900;">&#40;</span>fp<span style="color: #009900;">&#41;</span> <span style="color: #339933;">||</span> readSize <span style="color: #339933;">&lt;=</span><span style="color: #0000dd;">0</span> <span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> 
			<span style="color: #000000; font-weight: bold;">break</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span>
	<span style="color: #009900;">&#125;</span>
&nbsp;
ERROR<span style="color: #339933;">:</span>
	<span style="color: #666666; font-style: italic;">//free</span>
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>buff<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		free<span style="color: #009900;">&#40;</span>buff<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		buff<span style="color: #339933;">=</span>NULL<span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span> 
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>fp<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		fclose<span style="color: #009900;">&#40;</span>fp<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		fp<span style="color: #339933;">=</span>NULL<span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span>	
&nbsp;
    <span style="color: #b1b100;">return</span> ret<span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre></td></tr></table></div>

<p>Makefile:</p>

<div class="wp_syntax"><table><tr><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre class="c" style="font-family:monospace;">objects <span style="color: #339933;">=</span> main.<span style="color: #202020;">o</span> pcap.<span style="color: #202020;">o</span>
&nbsp;
pcaptest <span style="color: #339933;">:</span> $<span style="color: #009900;">&#40;</span>objects<span style="color: #009900;">&#41;</span>
	gcc <span style="color: #339933;">-</span>o pcaptest  $<span style="color: #009900;">&#40;</span>objects<span style="color: #009900;">&#41;</span>
&nbsp;
main.<span style="color: #202020;">o</span><span style="color: #339933;">:</span>pcap.<span style="color: #202020;">h</span>
pcap.<span style="color: #202020;">o</span><span style="color: #339933;">:</span>pcap.<span style="color: #202020;">h</span>
&nbsp;
.<span style="color: #202020;">PHONY</span> <span style="color: #339933;">:</span> clean
clean <span style="color: #339933;">:</span>
	rm pcaptest  $<span style="color: #009900;">&#40;</span>objects<span style="color: #009900;">&#41;</span></pre></td></tr></table></div>

</div>
					<div class="fixed"></div>
				</div>

				<div class="comments comments_single">
					<a href="index.html#respond">发表评论</a>
									</div>

				<!-- related posts START -->
								<!-- related posts END -->
			</div>

<a name="comments"></a>

<div class="ds-thread" data-thread-key="181" data-author-key="1" data-title="解析pcap文件及读取实现源码" data-url="http://imzc.net/archives/181/"></div>

<script type="text/javascript">
	if (typeof DUOSHUO !== 'undefined')
		DUOSHUO.EmbedThread('.ds-thread');
</script>
	<div id="ds-ssr">

		
            <ol id="commentlist">
                		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-22435">
			<article id="comment-22435" class="comment">
				<footer class="comment-meta">
					<cite class="comment-author vcard">
						<span class="fn">admin</span> on <a rel="nofollow" href="comment-page-1/index.html#comment-22435"><time pubdate datetime="2012-02-12T01:24:05+00:00">2012/02/12 at 01:24</time></a> <span class="says">said:</span>					</cite><!-- .comment-author .vcard -->
				</footer>
	
				<div class="comment-content"><p>pcap msend. </p>
</div>
				
			</article><!-- #comment-## -->
		</li>
            </ol>

		            
    </div>
			

	</div>

	<!-- sidebar START -->
<div id="sidebar">

<!-- Style Switcher START -->
<div class="widget">
	<div id="styleswitcher">
		<span id="style-text">主题风格: </span>
			<span id="style-green" class="color"><a onclick="TSS.setActiveStyleSheet('green');" href="javascript:void(0);" title="将主题风格更换为green"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-purple" class="color"><a onclick="TSS.setActiveStyleSheet('purple');" href="javascript:void(0);" title="将主题风格更换为purple"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-brown" class="color"><a onclick="TSS.setActiveStyleSheet('brown');" href="javascript:void(0);" title="将主题风格更换为brown"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-blue" class="color"><a onclick="TSS.setActiveStyleSheet('blue');" href="javascript:void(0);" title="将主题风格更换为blue"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-white" class="color"><a onclick="TSS.setActiveStyleSheet('white');" href="javascript:void(0);" title="将主题风格更换为white"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-black" class="color"><a onclick="TSS.setActiveStyleSheet('black');" href="javascript:void(0);" title="将主题风格更换为black"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
		<div class="fixed"></div>
	</div>
</div>
<!-- Style Switcher END -->

		<!-- showcase -->
		
		<ul id="widgets">

<li class="widget widget_calendar"><h3>Archives</h3><div id="calendar_wrap"><table id="wp-calendar">
	<caption>2012 年八月</caption>
	<thead>
	<tr>
		<th scope="col" title="星期日">日</th>
		<th scope="col" title="星期一">一</th>
		<th scope="col" title="星期二">二</th>
		<th scope="col" title="星期三">三</th>
		<th scope="col" title="星期四">四</th>
		<th scope="col" title="星期五">五</th>
		<th scope="col" title="星期六">六</th>
	</tr>
	</thead>

	<tfoot>
	<tr>
		<td colspan="3" id="prev"><a href="../date/2012/07/index.html" title="查看 2012 年七月的文章">&laquo; 七</a></td>
		<td class="pad">&nbsp;</td>
		<td colspan="3" id="next" class="pad">&nbsp;</td>
	</tr>
	</tfoot>

	<tbody>
	<tr>
		<td colspan="3" class="pad">&nbsp;</td><td><a href="../date/2012/08/01/index.html" title="配置vim rails集成开发环境">1</a></td><td><a href="../date/2012/08/02/index.html" title="安装ruby1.8.6后，gem错误的解决">2</a></td><td>3</td><td><a href="../date/2012/08/04/index.html" title="There was a problem installing &#8220;Mac OS X&#8221;.Try Reinstalling.">4</a></td>
	</tr>
	<tr>
		<td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td>
	</tr>
	<tr>
		<td id="today">12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td><td>18</td>
	</tr>
	<tr>
		<td>19</td><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td>
	</tr>
	<tr>
		<td>26</td><td>27</td><td>28</td><td>29</td><td>30</td><td>31</td>
		<td class="pad" colspan="1">&nbsp;</td>
	</tr>
	</tbody>
	</table></div></li><li class="widget widget_categories"><h3>分类目录</h3>		<ul>
	<li class="cat-item cat-item-7"><a href="../category/c_cplusplus/index.html" title="查看 C/C++ 下的所有文章">C/C++</a>
</li>
	<li class="cat-item cat-item-24"><a href="../category/ios-dev/index.html" title="查看 IOSDev 下的所有文章">IOSDev</a>
</li>
	<li class="cat-item cat-item-23"><a href="../category/java/index.html" title="查看 Java 下的所有文章">Java</a>
</li>
	<li class="cat-item cat-item-5"><a href="../category/lamp/index.html" title="查看 LAMP 下的所有文章">LAMP</a>
</li>
	<li class="cat-item cat-item-8"><a href="../category/onthego/index.html" title="查看 OnTheGo 下的所有文章">OnTheGo</a>
</li>
	<li class="cat-item cat-item-1"><a href="../category/other/index.html" title="查看 Other 下的所有文章">Other</a>
</li>
	<li class="cat-item cat-item-3"><a href="../category/project/index.html" title="查看 Project 下的所有文章">Project</a>
</li>
	<li class="cat-item cat-item-4"><a href="../category/rubytesting/index.html" title="查看 Ruby&amp;Testing 下的所有文章">Ruby&amp;Testing</a>
</li>
		</ul>
</li><li class="widget widget_text"><h3>Google Ads</h3>			<div class="textwidget"><script type="text/javascript"><!--
google_ad_client = "ca-pub-7220882232307827";
/* left_180x150, 创建于 09-2-19 */
google_ad_slot = "1136501676";
google_ad_width = 180;
google_ad_height = 150;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
		</li><li class="widget widget_tag_cloud"><h3>标签</h3><div class="tagcloud"><a href='../tag/c/index.html' class='tag-link-9' title='4 个话题' style='font-size: 22pt;'>c</a>
<a href='../tag/dailhelper/index.html' class='tag-link-13' title='1 个话题' style='font-size: 8pt;'>dailhelper</a>
<a href='../tag/linux/index.html' class='tag-link-14' title='1 个话题' style='font-size: 8pt;'>linux</a>
<a href='../tag/ls/index.html' class='tag-link-10' title='1 个话题' style='font-size: 8pt;'>ls</a>
<a href='../tag/makefile/index.html' class='tag-link-17' title='1 个话题' style='font-size: 8pt;'>makefile</a>
<a href='../tag/netkeeper/index.html' class='tag-link-16' title='1 个话题' style='font-size: 8pt;'>Netkeeper</a>
<a href='../tag/pcap/index.html' class='tag-link-25' title='1 个话题' style='font-size: 8pt;'>pcap</a>
<a href='../tag/ruby/index.html' class='tag-link-12' title='1 个话题' style='font-size: 8pt;'>ruby</a>
<a href='../tag/slab/index.html' class='tag-link-20' title='1 个话题' style='font-size: 8pt;'>slab</a>
<a href='../tag/wget/index.html' class='tag-link-11' title='1 个话题' style='font-size: 8pt;'>wget</a>
<a href='../tag/系%259F管%2590%2586/index.html' class='tag-link-15' title='1 个话题' style='font-size: 8pt;'>系统管理</a></div>
</li><li class="widget widget_links"><h3>链接表</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://blog.csdn.net/Android_Tutor" rel="colleague" title="Android_Tutor的专栏" target="_blank">Android学习系列</a></li>
<li><a href="http://ihower.tw/rails3/" title="Rails3学习,写得不错!">Rails3学习</a></li>
<li><a href="http://wpotp.com" rel="me" title="食品找茬网" target="_blank">找茬网</a></li>
<li><a href="http://www.sz95000.com/" title="深圳长途汽车网上订票，官方网站，这次不会忘记了。。。" target="_blank">深圳长途汽车网上订票</a></li>

	</ul>
</li>
<li class="widget widget_meta"><h3>功能</h3>			<ul>
			<li><a href="../../wp-login.php?action=register">注册</a></li>			<li><a href="../../wp-login.php">登录</a></li>
			<li><a href="../../feed/index.html" title="使用 RSS 2.0 订阅本站点内容">文章 <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="../../comments/feed/index.html" title="使用 RSS 订阅本站点的所有文章的近期评论">评论 <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://cn.wordpress.org/" title="基于 WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li>
						</ul>
</li>		</ul>

		<!-- showcase 2 -->
		
</div>
<!-- sidebar END -->

	<div class="fixed"></div>

		<div id="bottom">
			<div class="postnav">
				<span class="alignleft">&laquo; <a href="../179/index.html" rel="prev">Windows获取开机时间</a></span>
				<span class="alignright"><a href="../188/index.html" rel="next">plist简单的读写方法</a> &raquo;</span>
				<div class="fixed"></div>
			</div>

			<div class="anchor">
				<span><a href="index.html#" onclick="MGJS.goTop();return false;">置顶</a></span>
			</div>
			<div class="fixed"></div>
			</div>
		<div class="fixed"></div>
	</div>
</div>

<!-- footer START -->
<div id="footer">
	<div class="inner">
		<div class="content">
			<p id="about">
				版权所有 &copy; 2008-2012 Only For Sunshine~ | 基于 <a href="http://wordpress.org/">WordPress</a> | 主题由 <a href="http://www.neoease.com/">NeoEase</a> 提供			</p>

			<ul id="admin">
				<li><a href="../../wp-login.php?action=register">注册</a></li>				<li><a href="../../wp-login.php">登录</a></li>
			</ul>

			<div class="fixed"></div>
		</div>
	</div>
</div><!-- footer END --><script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?aa&#038;ver=3.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/wpgroho.js?ver=3.4.1'></script>
	<div style="display:none">
	</div>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201232'></script>

	<script src="http://stats.wordpress.com/e-201232.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:1.6.1',blog:'17044931',post:'181'});
	var load_cmc = function(){linktracker_init(17044931,181,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9565349-1']);
  _gaq.push(['_setDomainName', 'imzc.net']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
</body>
</html>

<!-- Dynamic page generated in 0.730 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-08-12 20:42:16 -->
<!-- super cache -->