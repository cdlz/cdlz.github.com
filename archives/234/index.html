<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

	<title>autoit3实现命令行调用杀毒软件 | Only For Sunshine~</title>
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有文章" href="../../feed/index.html" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有评论" href="../../comments/feed/index.html" />
	<link rel="pingback" href="../../xmlrpc.php" />

	<!-- style START -->
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/style.css" type="text/css" media="screen" />
			<link rel="stylesheet" href="../../wp-content/themes/elegant-box/chinese.css" type="text/css" media="screen" />
		<!--[if IE]>
		<link rel="stylesheet" href="http://imzc.net/wp-content/themes/elegant-box/ie.css" type="text/css" media="screen" />
	<![endif]-->

	<!-- default style -->
			<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/blue/default.css" type="text/css" media="screen" title="blue" />
		<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/blue/global.css" type="text/css" media="screen" />
	
	<!-- others styles -->
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/green/default.css" type="text/css" media="screen" title="green" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/green/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/purple/default.css" type="text/css" media="screen" title="purple" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/purple/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/brown/default.css" type="text/css" media="screen" title="brown" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/brown/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/white/default.css" type="text/css" media="screen" title="white" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/white/global.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/black/default.css" type="text/css" media="screen" title="black" />
	<link rel="stylesheet" href="../../wp-content/themes/elegant-box/styles/black/global.css" type="text/css" media="screen" />
	<!-- style END -->

	<!-- javascript START -->
			<script type="text/javascript" src="../../wp-content/themes/elegant-box/js/styleswitcher.js"></script>
		<script type="text/javascript" src="../../wp-content/themes/elegant-box/js/base.js"></script>
	<script type="text/javascript" src="../../wp-content/themes/elegant-box/js/menu.js"></script>
	<!-- javascript END -->

		<link rel='stylesheet' id='jquery.slimbox-css'  href='../../wp-content/plugins/slimbox/stylesheets/jquery.slimbox.css?ver=2.03' type='text/css' media='all' />
<link rel='stylesheet' id='wp-pagenavi-css'  href='../../wp-content/themes/elegant-box/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery.js?ver=1.7.2'></script>
<script type='text/javascript' src='../../wp-content/plugins/slimbox/javascript/jquery.slimbox.js?ver=2.03'></script>
<script type='text/javascript' src='../../wp-includes/js/json2.js?ver=2011-02-23'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var live_blogging = {"ajaxurl":"http:\/\/imzc.net\/wp-admin\/admin-ajax.php","update_effect":"top"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/live-blogging/live-blogging.js?ver=3.4.1'></script>
<script type='text/javascript' src='../../wp-includes/js/comment-reply.js?ver=3.4.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Ruby多线程与同时使用autoit和watir处理popup弹框时的关系' href='../231/index.html' />
<link rel='next' title='ruby调用OLE实现word输出(支持嵌入图片)' href='../238/index.html' />
<meta name="generator" content="WordPress 3.4.1" />
<link rel='shortlink' href='http://wp.me/p19waf-3M' />

<!-- All in One SEO Pack 1.6.14.5 by Michael Torbert of Semper Fi Web Design[343,417] -->
<meta name="description" content="autoit3实现命令行调用杀毒软件" />
<meta name="keywords" content="autoit3,命令行调用杀毒软件,wm_contextmenu,_guictrlmenu_getitemtext" />
<link rel="canonical" href="index.html" />
<!-- /all in one seo pack -->
<script type="text/javascript">
	jQuery(document).ready(function($){	
	    var select = $('a[href$=".bmp"],a[href$=".gif"],a[href$=".jpg"],a[href$=".jpeg"], a[href$=".png"],a[href$=".BMP"],a[href$=".GIF"],a[href$=".JPG"],a[href$=".JPEG"],a[href$=".PNG"]');
		select.slimbox();
	});
</script>

<link rel="stylesheet" href="../../wp-content/themes/elegant-box/wp-syntax.css" type="text/css" media="screen" />
</head>


<body>
	<!-- header START -->
	<div id="header">
		<div class="inner">
			<div class="content">
				<div class="caption">
					<h1 id="title"><a href="../../index.html" title="-More Thinking,And Then Just do it~~~">Only For Sunshine~</a></h1>
					<div id="tagline">-More Thinking,And Then Just do it~~~</div>
				</div>

				<!-- search box -->
									<form action="http://www.google.com/cse" id="search_box" method="get">
						<div id="searchbox">
							<input type="text" id="searchtxt" class="textfield" name="q" size="24" />
							<input type="hidden" name="cx" value="007838838681523399853:u4canb53vle" />
							<input type="hidden" name="ie" value="UTF-8" />
						</div>
					</form>
				<script type="text/javascript">
//<![CDATA[
	var searchbox = document.getElementById("searchbox");
	var searchtxt = document.getElementById("searchtxt");
	var tiptext = "请输入关键字...";
	if(searchtxt.value == "" || searchtxt.value == tiptext) {
		searchtxt.className += " searchtip";
		searchtxt.value = tiptext;
	}
	searchtxt.onfocus = function(e) {
		if(searchtxt.value == tiptext) {
			searchtxt.value = "";
			searchtxt.className = searchtxt.className.replace(" searchtip", "");
		}
	}
	searchtxt.onblur = function(e) {
		if(searchtxt.value == "") {
			searchtxt.className += " searchtip";
			searchtxt.value = tiptext;
		}
	}
//]]>
</script>

				<!-- navigation START -->
				<ul id="navigation">

					<li class="page_item"><a href="../../index.html">首页</a></li>
					<li class="page_item page-item-260"><a href="../../ios/index.html">IOS_PROJ</a></li>
<li class="page_item page-item-164"><a href="../../wp_otp/index.html">WP_OTP</a></li>
<li class="page_item page-item-180"><a href="../../vps-recommended/index.html">vps推荐</a></li>
<li class="page_item page-item-139"><a href="../../mysites/index.html">我的站点</a></li>
<li class="page_item page-item-2"><a href="../../aboutme/index.html">关于</a></li>
					<li id="subscribe">
						<a rel="external nofollow" title="订阅这个博客的文章" id="feed" href="../../feed/index.html"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="RSS 订阅" /></a>
													<ul>
								<li class="first"><a rel="external nofollow" title="订阅到有道" href="http://reader.youdao.com/b.do?url=http://imzc.net/feed/"> 有道</a></li>
								<li><a rel="external nofollow" title="订阅到鲜果" href="http://www.xianguo.com/subscribe.php?url=http://imzc.net/feed/"> 鲜果</a></li>
								<li><a rel="external nofollow" title="订阅到抓虾" href="http://www.zhuaxia.com/add_channel.php?url=http://imzc.net/feed/"> 抓虾</a></li>
								<li><a rel="external nofollow" title="订阅到 Google" href="http://fusion.google.com/add?feedurl=http://imzc.net/feed/">  Google</a></li>
								<li><a rel="external nofollow" title="订阅到 My Yahoo!" href="http://add.my.yahoo.com/rss?url=http://imzc.net/feed/">  My Yahoo!</a></li>
								<li><a rel="external nofollow" title="订阅到 newsgator" href="http://www.newsgator.com/ngs/subscriber/subfext.aspx?url=http://imzc.net/feed/">  newsgator</a></li>
								<li><a rel="external nofollow" title="订阅到 Bloglines" href="http://www.bloglines.com/sub/http://imzc.net/feed/">  Bloglines</a></li>
								<li><a rel="external nofollow" title="订阅到 哪吒" href="http://inezha.com/add?url=http://imzc.net/feed/">  哪吒</a></li>
							</ul>
											</li>

				</ul>
				<!-- navigation END -->

			</div>
		</div>
	</div>
	<!-- header END -->

	<div id="container">
		<div id="content">
			<div id="main">

		
			<div class="post">
				<div class="title">
					<h2>autoit3实现命令行调用杀毒软件</h2>
					<div class="fixed"></div>
				</div>

				<div class="info">
					
					<span>2012年3月30日</span>
											<span> | 分类: <a href="../category/rubytesting/index.html" title="查看 Ruby&amp;Testing 中的全部文章" rel="category tag">Ruby&amp;Testing</a></span>
																<span> | 标签: </span>
					
					<div class="fixed"></div>
				</div>

				<div class="content">
<div style=”padding:3px 0″>
<script type="text/javascript"><!--
google_ad_client = "pub-7220882232307827";
/* blog_468x15, Created @09-2-19 */
google_ad_slot = "1127450986";
google_ad_width = 468;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<br />	
					<p>自动化项目需要调用杀毒软件对特定文件夹进行病毒扫描，但是大部分杀毒软件都没有提供命令行支持。因此只能从图形界面操作搞定。<br />
sikuli可以实现截图方式点击，但是不太稳定，而且，对于趋势杀毒软件，只能选择到某个盘符，不能选择到具体的文件夹，故存在一定的弱点。<br />
考虑到杀毒软件都有提供一个右键菜单，查询注册表发现是一个shellext.dll扩展，不能通过rundll32方式调用。因此可以考虑使用autoit进行操作了。重要知识点：<br />
1.使用windows资源管理器打开特定的文件夹，且处于选中状态，explorer支持多种参数，其中select是实现本功能的参数：<br />
RunWait(@ComSpec &amp; &#8216; /c &#8216; &amp; &#8216;explorer /select,&#8217; &amp; $DirName,&#8221;, @SW_HIDE)</p>
<p> 2.有些时候对应的文件夹已经处于打开状态，且可能选中到其他文件夹，因此需要使用autoit3的函数，将所有文件夹取消选中。<br />
 而特定的文件夹再设置为selected。<br />
 3.直接通过_GUICtrlMenu_GetMenu($hWnd)函数总是失败，因此只有采取变通的手段，通过发送windows消息来获取响应的菜单句柄。<br />
 $hMenu = _SendMessage($hWnd, 0x01E1) ;0x01E1 MN_GETHMENU<br />
 4.由于autoit3的GuiMenu.au3还未提供click对应item的功能，因此只能通过发送快捷键： {DOWN}，{ENTER}来实现选择菜单。<br />
 5.右键菜单曾经打算使用发送WM_CONTEXTMENU消息获得，但是发现在某些机子上面又不行，<br />
 ;007B WM_CONTEXTMENU<br />
 ;_WinAPI_PostMessage($hWnd, 0x007B, 0, 0)<br />
 所以只得采取另外的方法：SHIFT+F10，快捷键很爽啊。。。<br />
 6._GUICtrlMenu_GetItemText($hMenu, $iItem[, $fByPos = True])函数有些时候获取不到菜单的名称（可能是程序内部处理了，如360杀毒），因此需要提供通过索引的方式点击。。。<br />
 7.autoit3编译为exe文件，需要选取“console”（默认是GUI的），以便查看程序输出情况。<br />
使用参数： scan &#8220;E:\待扫描文件&#8221; &#8220;使用|扫描|查杀&#8221;<br />
           scan &#8220;E:\待扫描文件&#8221; &#8220;使用|扫描|查杀&#8221;  15 （最后一个参数是在获取不到对应菜单时，直接点击菜单项目序号，排除空白的）<br />
 具体源码见下：</p>

<div class="wp_syntax"><div class="code"><pre class="vbnet" style="font-family:monospace;">#Include &lt;GuiListView.<span style="color: #0000FF;">au3</span>&gt; 
#include &lt;WinAPI.<span style="color: #0000FF;">au3</span>&gt;  
#include &lt;GuiMenu.<span style="color: #0000FF;">au3</span>&gt;
&nbsp;
&nbsp;
&nbsp;
;scan.<span style="color: #0000FF;">exe</span> <span style="color: #808080;">&quot;E:\att_proj\360scan&quot;</span> <span style="color: #808080;">&quot;使用 ESET NOD32 Antivirus 扫描&quot;</span>
&nbsp;
$DirName <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;E:\待扫描文件&quot;</span>
$AntiVirusSoftName <span style="color: #008000;">=</span>  <span style="color: #808080;">&quot;扫描&quot;</span>
&nbsp;
$itemToClick <span style="color: #008000;">=</span> <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span>
&nbsp;
<span style="color: #0600FF;">If</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">=</span><span style="color: #FF0000;">1</span> <span style="color: #FF8000;">Then</span>
&nbsp;
&nbsp;
<span style="color: #0600FF;">If</span> $cmdline<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">2</span> or $cmdline<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">3</span> <span style="color: #FF8000;">Then</span>
    $DirName <span style="color: #008000;">=</span> $cmdline<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span>
  $AntiVirusSoftName <span style="color: #008000;">=</span> $cmdline<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#93;</span> 
  <span style="color: #0600FF;">If</span> $cmdline<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">3</span> <span style="color: #FF8000;">Then</span> $itemToClick <span style="color: #008000;">=</span>  $cmdline<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">3</span><span style="color: #000000;">&#93;</span>
<span style="color: #FF8000;">Else</span>     
  ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'Please use this program with two/three argvs, 目录名称 and 右键菜单.'&amp; @CRLF)</span>
  ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'Such as programName &quot;D:\appserv&quot; &quot;使用 ESET NOD32 Antivirus 扫描&quot;.' &amp; @CRLF)</span>
  ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'Such as programName &quot;D:\appserv&quot; &quot;使用 ESET NOD32 Antivirus 扫描&quot; itermnum(begin at zero) .' &amp; @CRLF)</span>
  <span style="color: #0600FF;">exit</span>
EndIf 
&nbsp;
<span style="color: #0600FF;">If</span> FileExists<span style="color: #000000;">&#40;</span>$DirName<span style="color: #000000;">&#41;</span><span style="color: #008000;">=</span><span style="color: #FF0000;">0</span> <span style="color: #FF8000;">Then</span>
    ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'DirName:'&amp;$DirName&amp;' is not exists.' &amp; @CRLF)</span>
  <span style="color: #0600FF;">exit</span>
EndIf
&nbsp;
EndIf
&nbsp;
ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'$DirName:'&amp;$DirName&amp;',$AntiVirusSoftName:'&amp;$AntiVirusSoftName &amp; @CRLF)</span>
&nbsp;
$array <span style="color: #008000;">=</span> StringSplit<span style="color: #000000;">&#40;</span>$DirName, <span style="color: #008080; font-style: italic;">'\', 1)</span>
$ItemName <span style="color: #008000;">=</span> $array<span style="color: #000000;">&#91;</span><span style="color: #0600FF;">UBound</span><span style="color: #000000;">&#40;</span>$array<span style="color: #000000;">&#41;</span><span style="color: #008000;">-</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span>
ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'$ItemName:'&amp;$ItemName&amp; @CRLF)</span>
&nbsp;
;close all window
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
;While <span style="color: #FF0000;">1</span> ;use infinite <span style="color: #0600FF;">loop</span> since ExitLoop will <span style="color: #FF8000;">get</span> called
;   $TITLE <span style="color: #008000;">=</span> WinGetTitle<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;[CLASS:CabinetWClass]&quot;</span>,<span style="color: #808080;">&quot;&quot;</span><span style="color: #000000;">&#41;</span>
;  ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Try to Close one control: [CLASS:CabinetWClass],title:&quot;</span><span style="color: #008000;">&amp;</span>$TITLE<span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>
;  $hanlde <span style="color: #008000;">=</span> WinGetHandle<span style="color: #000000;">&#40;</span>$TITLE<span style="color: #000000;">&#41;</span> 
 ;   $ans <span style="color: #008000;">=</span> WinClose<span style="color: #000000;">&#40;</span>$hanlde<span style="color: #000000;">&#41;</span>  
 ;   <span style="color: #0600FF;">If</span> $ans <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span> <span style="color: #FF8000;">Then</span> ExitLoop
;WEnd 
&nbsp;
RunWait<span style="color: #000000;">&#40;</span>@ComSpec <span style="color: #008000;">&amp;</span> <span style="color: #008080; font-style: italic;">' /c ' &amp; 'explorer /select,' &amp; $DirName,'', @SW_HIDE)</span>
&nbsp;
Opt<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;WinTitleMatchMode&quot;</span>, <span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span>     ;<span style="color: #FF0000;">1</span><span style="color: #008000;">=</span>start, <span style="color: #FF0000;">2</span><span style="color: #008000;">=</span>subStr, <span style="color: #FF0000;">3</span><span style="color: #008000;">=</span>exact, <span style="color: #FF0000;">4</span><span style="color: #008000;">=</span>advanced, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span> <span style="color: #FF8000;">to</span> <span style="color: #008000;">-</span><span style="color: #FF0000;">4</span><span style="color: #008000;">=</span>Nocase
&nbsp;
WinSetState<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;[CLASS:CabinetWClass]&quot;</span>, <span style="color: #808080;">&quot;&quot;</span>, @SW_SHOW<span style="color: #000000;">&#41;</span>
;WinActivate<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;[CLASS:CabinetWClass]&quot;</span>, <span style="color: #808080;">&quot;&quot;</span><span style="color: #000000;">&#41;</span>
&nbsp;
;$hWnd <span style="color: #008000;">=</span> ControlGetHandle<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;&quot;</span>,<span style="color: #808080;">&quot;FolderView&quot;</span>,<span style="color: #808080;">&quot;[CLASS:SysListView32]&quot;</span><span style="color: #000000;">&#41;</span>
$hWnd <span style="color: #008000;">=</span> ControlGetHandle<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;&quot;</span>,<span style="color: #808080;">&quot;FolderView&quot;</span>,<span style="color: #808080;">&quot;[CLASS:SysListView32; INSTANCE:1]&quot;</span><span style="color: #000000;">&#41;</span>
&nbsp;
;$pos <span style="color: #008000;">=</span> ControlGetPos<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;&quot;</span>,<span style="color: #808080;">&quot;FolderView&quot;</span>,<span style="color: #808080;">&quot;[CLASS:SysListView32]&quot;</span><span style="color: #000000;">&#41;</span>
;MsgBox<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #808080;">&quot;Window Stats:&quot;</span>, <span style="color: #808080;">&quot;POS: &quot;</span> <span style="color: #008000;">&amp;</span> $pos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">&amp;</span> <span style="color: #808080;">&quot;,&quot;</span> <span style="color: #008000;">&amp;</span> $pos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">&amp;</span> <span style="color: #808080;">&quot; SIZE: &quot;</span> <span style="color: #008000;">&amp;</span> $pos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">&amp;</span> <span style="color: #808080;">&quot;,&quot;</span> <span style="color: #008000;">&amp;</span> $pos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">3</span><span style="color: #000000;">&#93;</span> <span style="color: #000000;">&#41;</span>
&nbsp;
&nbsp;
&nbsp;
$items  <span style="color: #008000;">=</span> _GUICtrlListView_GetItemCount<span style="color: #000000;">&#40;</span>$hWnd<span style="color: #000000;">&#41;</span>
&nbsp;
&nbsp;
;ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Item Count: &quot;</span> <span style="color: #008000;">&amp;</span> $items <span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>
&nbsp;
;ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Item  Focused: &quot;</span> <span style="color: #008000;">&amp;</span> _GUICtrlListView_GetItemFocused<span style="color: #000000;">&#40;</span>$hWnd, <span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #FF8000;">For</span> $i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span> <span style="color: #FF8000;">To</span> $items <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span>
 $ItemText <span style="color: #008000;">=</span> _GUICtrlListView_GetItemText<span style="color: #000000;">&#40;</span>$hWnd, $i<span style="color: #000000;">&#41;</span>
 ;ConsoleWrite<span style="color: #000000;">&#40;</span>$ItemText<span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>
 _GUICtrlListView_SetItemSelected<span style="color: #000000;">&#40;</span>$hWnd,$i,<span style="color: #0600FF;">False</span><span style="color: #000000;">&#41;</span>
 Sleep<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">10</span><span style="color: #000000;">&#41;</span>
 <span style="color: #0600FF;">If</span> $ItemText <span style="color: #008000;">=</span> $ItemName <span style="color: #FF8000;">Then</span>
  $aRect <span style="color: #008000;">=</span> _GUICtrlListView_GetItemRect<span style="color: #000000;">&#40;</span>$hWnd,$i<span style="color: #000000;">&#41;</span>
  ConsoleWrite<span style="color: #000000;">&#40;</span>StringFormat<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Item 2 Rectangle : [%d, %d, %d, %d]&quot;</span>, $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>, $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span>, $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#93;</span>, $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>
&nbsp;
  $aPos <span style="color: #008000;">=</span> _GUICtrlListView_GetItemPosition<span style="color: #000000;">&#40;</span>$hWnd, $i<span style="color: #000000;">&#41;</span>
  ConsoleWrite<span style="color: #000000;">&#40;</span>StringFormat<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Item Position : [%d, %d]&quot;</span>, $aPos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>, $aPos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>
&nbsp;
  ;MouseMove <span style="color: #000000;">&#40;</span>$aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#93;</span>, $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>
  ;Sleep<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">2000</span><span style="color: #000000;">&#41;</span>
  ;ControlClick<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;&quot;</span>,<span style="color: #808080;">&quot;FolderView&quot;</span>,<span style="color: #808080;">&quot;[CLASS:SysListView32]&quot;</span>,<span style="color: #808080;">&quot;right&quot;</span>,<span style="color: #FF0000;">1</span>,$aPos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span><span style="color: #008000;">+</span><span style="color: #FF0000;">20</span>,$aPos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span><span style="color: #008000;">+</span><span style="color: #FF0000;">20</span><span style="color: #000000;">&#41;</span>
&nbsp;
    $centerX <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span>$aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">+</span> $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">/</span><span style="color: #FF0000;">2</span>
  $centerY <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span>$aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">+</span> $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">/</span><span style="color: #FF0000;">2</span>
  $aPos <span style="color: #008000;">=</span> _GUICtrlListView_GetItemPosition<span style="color: #000000;">&#40;</span>$hWnd, $i<span style="color: #000000;">&#41;</span>
  ConsoleWrite<span style="color: #000000;">&#40;</span>StringFormat<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Item Position : [%d, %d]&quot;</span>, $aPos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>, $aPos<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>
&nbsp;
  _GUICtrlListView_SetItemSelected<span style="color: #000000;">&#40;</span>$hWnd,$i<span style="color: #000000;">&#41;</span>
&nbsp;
  ;MouseMove <span style="color: #000000;">&#40;</span>$aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#93;</span>, $aRect<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>
  ;Sleep<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">2000</span><span style="color: #000000;">&#41;</span>
  ;ControlClick<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;&quot;</span>,<span style="color: #808080;">&quot;FolderView&quot;</span>,<span style="color: #808080;">&quot;[CLASS:SysListView32]&quot;</span>,<span style="color: #808080;">&quot;right&quot;</span>,<span style="color: #FF0000;">1</span>,$centerX,$centerY<span style="color: #000000;">&#41;</span>
&nbsp;
  ;ExitLoop 
 EndIf
&nbsp;
<span style="color: #FF8000;">Next</span>
&nbsp;
&nbsp;
&nbsp;
;MsgBox<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #808080;">&quot;HWnd:t,c&quot;</span>, $hWndf <span style="color: #008000;">&amp;</span><span style="color: #808080;">&quot;,&quot;</span><span style="color: #008000;">&amp;</span>$hWnd<span style="color: #000000;">&#41;</span>
;007B WM_CONTEXTMENU
;0x001611DA
;_WinAPI_PostMessage<span style="color: #000000;">&#40;</span>$hWnd, 0x007B, 0x001611da,0x00d30342<span style="color: #000000;">&#41;</span>
&nbsp;
;_WinAPI_PostMessage<span style="color: #000000;">&#40;</span>$hWnd, 0x007B, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span><span style="color: #000000;">&#41;</span>;<span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">100</span><span style="color: #000000;">&#41;</span>
&nbsp;
Opt<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'WinSearchChildren', 1)</span>
&nbsp;
HotKeySet<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'{ESC}', '_EXIT')</span>
OnAutoItExitRegister<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'OnAutoItExit')</span>
&nbsp;
Global <span style="color: #0600FF;">Const</span> $MN_GETHMENU <span style="color: #008000;">=</span> 0x01E1
Global <span style="color: #0600FF;">Const</span> $EVENT_SYSTEM_MENUPOPUPSTART <span style="color: #008000;">=</span> 0x0006
Global <span style="color: #0600FF;">Const</span> $EVENT_SYSTEM_MENUPOPUPEND <span style="color: #008000;">=</span> 0x0007  
Global $hFunc, $pFunc
Global $hWinHook
&nbsp;
$hFunc <span style="color: #008000;">=</span> DllCallbackRegister<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'_WinEventProc', 'none', 'ptr;uint;hwnd;int;int;uint;uint')</span>
$pFunc <span style="color: #008000;">=</span> DllCallbackGetPtr<span style="color: #000000;">&#40;</span>$hFunc<span style="color: #000000;">&#41;</span>
$hWinHook <span style="color: #008000;">=</span> _SetWinEventHook<span style="color: #000000;">&#40;</span>0x00000001, 0x7FFFFFFF, <span style="color: #FF0000;">0</span>, $pFunc, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span>,<span style="color: #804040;">BitOR</span><span style="color: #000000;">&#40;</span>0x0002, 0x0000<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
&nbsp;
&nbsp;
 Send<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;+{F10}&quot;</span><span style="color: #000000;">&#41;</span> ;弹出右键菜单
&nbsp;
&nbsp;
&nbsp;
<span style="color: #0600FF;">While</span> <span style="color: #FF0000;">1</span>
        Sleep<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">20</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">WEnd</span>
&nbsp;
<span style="color: #FF8000;">Func</span> _EXIT<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0600FF;">Exit</span>
EndFunc   ;<span style="color: #008000;">==</span>&gt;_EXIT
&nbsp;
<span style="color: #FF8000;">Func</span> OnAutoItExit<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
        _UnhookWinEvent<span style="color: #000000;">&#40;</span>$hWinHook<span style="color: #000000;">&#41;</span>
        DllCallbackFree<span style="color: #000000;">&#40;</span>$hFunc<span style="color: #000000;">&#41;</span>
EndFunc   ;<span style="color: #008000;">==</span>&gt;OnAutoItExit
&nbsp;
<span style="color: #FF8000;">Func</span> _WinEventProc<span style="color: #000000;">&#40;</span>$hHook, $iEvent, $hWnd, $iObjectID, $iChildID, $iEventThread, $imsEventTime<span style="color: #000000;">&#41;</span>
        Local $hMenu
&nbsp;
      <span style="color: #0600FF;">If</span> $iEvent <span style="color: #008000;">=</span> $EVENT_SYSTEM_MENUPOPUPSTART  <span style="color: #FF8000;">Then</span>
                $hMenu <span style="color: #008000;">=</span> _SendMessage<span style="color: #000000;">&#40;</span>$hWnd, 0x01E1<span style="color: #000000;">&#41;</span> ;0x01E1 MN_GETHMENU 
                <span style="color: #0600FF;">If</span> _GUICtrlMenu_IsMenu<span style="color: #000000;">&#40;</span>$hMenu<span style="color: #000000;">&#41;</span> <span style="color: #FF8000;">Then</span>
&nbsp;
            <span style="color: #0600FF;">If</span> $itemToClick &lt;&gt; <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span> <span style="color: #FF8000;">Then</span>
&nbsp;
              ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Click menu item direct.&quot;</span><span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>; 
               <span style="color: #FF8000;">For</span> $i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span> <span style="color: #FF8000;">To</span> _GUICtrlMenu_GetItemCount<span style="color: #000000;">&#40;</span>$hMenu<span style="color: #000000;">&#41;</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">1</span>
                Send <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;{DOWN}&quot;</span><span style="color: #000000;">&#41;</span> 
                <span style="color: #0600FF;">If</span> $itemToClick <span style="color: #008000;">=</span> $i <span style="color: #FF8000;">Then</span>
                  ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Click menu item :&quot;</span> <span style="color: #008000;">&amp;</span>$itemToClick<span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>;  
                  Sleep<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1000</span><span style="color: #000000;">&#41;</span>
                  Send <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;{ENTER}&quot;</span><span style="color: #000000;">&#41;</span> 
                  ExitLoop
                  EndIf
&nbsp;
              <span style="color: #FF8000;">Next</span> 
              <span style="color: #0600FF;">Exit</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#41;</span>
            <span style="color: #FF8000;">Else</span> 
              $i<span style="color: #008000;">=</span><span style="color: #FF0000;">0</span>
              <span style="color: #FF8000;">For</span> $i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span> <span style="color: #FF8000;">To</span> _GUICtrlMenu_GetItemCount<span style="color: #000000;">&#40;</span>$hMenu<span style="color: #000000;">&#41;</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">1</span>
&nbsp;
                  Sleep<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">10</span><span style="color: #000000;">&#41;</span>  
                  Local $sItemText <span style="color: #008000;">=</span> _GUICtrlMenu_GetItemText<span style="color: #000000;">&#40;</span>$hMenu, $i<span style="color: #000000;">&#41;</span>
&nbsp;
                  ConsoleWrite<span style="color: #000000;">&#40;</span>$sItemText<span style="color: #008000;">&amp;</span><span style="color: #808080;">&quot;,item index:&quot;</span><span style="color: #008000;">&amp;</span>$i <span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>; 
&nbsp;
                  <span style="color: #0600FF;">If</span> $sItemText <span style="color: #008000;">=</span> <span style="color: #008080; font-style: italic;">'' Then ContinueLoop    </span>
&nbsp;
                  Send <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;{DOWN}&quot;</span><span style="color: #000000;">&#41;</span>
                  ;If StringInStr<span style="color: #000000;">&#40;</span>$sItemText,$AntiVirusSoftName<span style="color: #000000;">&#41;</span> &lt;&gt; <span style="color: #FF0000;">0</span> <span style="color: #FF8000;">Then</span>
                  <span style="color: #0600FF;">If</span> StringRegExp <span style="color: #000000;">&#40;</span>$sItemText,$AntiVirusSoftName,<span style="color: #FF0000;">0</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">=</span><span style="color: #FF0000;">1</span> <span style="color: #FF8000;">Then</span>
                    ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;StringRegExp match,item index:&quot;</span><span style="color: #008000;">&amp;</span>$i <span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>; 
                    ;MsgBox<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #808080;">&quot;HWnd&quot;</span>, <span style="color: #808080;">&quot;nod32&quot;</span><span style="color: #000000;">&#41;</span>
                    ;$subviewid <span style="color: #008000;">=</span> _GUICtrlMenu_GetItemID<span style="color: #000000;">&#40;</span>$hMenu, $i<span style="color: #000000;">&#41;</span>
                    ;_GUICtrlMenu_SetItemState<span style="color: #000000;">&#40;</span>$hMenu, $i, $MFS_CHECKED,<span style="color: #0600FF;">True</span><span style="color: #000000;">&#41;</span>
                    ;_GUICtrlMenu_SetItemDisabled<span style="color: #000000;">&#40;</span>$hMenu, $i<span style="color: #000000;">&#41;</span>
                    ;Send <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;{ENTER}&quot;</span><span style="color: #000000;">&#41;</span> 
                    Sleep<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1000</span><span style="color: #000000;">&#41;</span>
                    Send <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;{ENTER}&quot;</span><span style="color: #000000;">&#41;</span>
                    ;ControlClick<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;&quot;</span>, <span style="color: #808080;">&quot;&quot;</span>,$subviewid ,<span style="color: #808080;">&quot;left&quot;</span><span style="color: #000000;">&#41;</span> 
                    ExitLoop
                  EndIf
&nbsp;
              <span style="color: #FF8000;">Next</span> 
               <span style="color: #0600FF;">If</span> $i <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span>_GUICtrlMenu_GetItemCount<span style="color: #000000;">&#40;</span>$hMenu<span style="color: #000000;">&#41;</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #FF8000;">Then</span> ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Not found,then click the first null menu.&quot;</span> <span style="color: #008000;">&amp;</span> @<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span> 
            EndIf
          <span style="color: #0600FF;">Exit</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#41;</span>
          EndIf
&nbsp;
                ConsoleWrite<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Not Menu hwnd.&quot;</span>@<span style="color: #0600FF;">CRLF</span><span style="color: #000000;">&#41;</span>
      EndIf
&nbsp;
&nbsp;
&nbsp;
&nbsp;
EndFunc   ;<span style="color: #008000;">==</span>&gt;_WinEventProc
&nbsp;
<span style="color: #FF8000;">Func</span> _SetWinEventHook<span style="color: #000000;">&#40;</span>$ieventMin, $ieventMax, $hMod, $pCallback, $iProcID, $iThreadID, $iFlags<span style="color: #000000;">&#41;</span>
        Local $aRet
&nbsp;
        $aRet <span style="color: #008000;">=</span> DllCall<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'user32.dll', 'ptr', 'SetWinEventHook', 'uint', $ieventMin, 'uint', $ieventMax, _</span>
                        <span style="color: #008080; font-style: italic;">'hwnd', $hMod, 'ptr', $pCallback, 'dword', $iProcID, 'dword', $iThreadID, 'uint', $iFlags)</span>
&nbsp;
        <span style="color: #0600FF;">If</span> @<span style="color: #FF8000;">error</span> Or $aRet<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span> <span style="color: #FF8000;">Then</span> <span style="color: #FF8000;">Return</span> SetError<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span><span style="color: #000000;">&#41;</span>
        <span style="color: #FF8000;">Return</span> $aRet<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>
EndFunc   ;<span style="color: #008000;">==</span>&gt;_SetWinEventHook
&nbsp;
<span style="color: #FF8000;">Func</span> _UnhookWinEvent<span style="color: #000000;">&#40;</span>$hWinEventHook<span style="color: #000000;">&#41;</span>
        Local $aRet
&nbsp;
        $aRet <span style="color: #008000;">=</span> DllCall<span style="color: #000000;">&#40;</span><span style="color: #008080; font-style: italic;">'user32.dll', 'int', 'UnhookWinEvent', 'ptr', $hWinEventHook)</span>
        <span style="color: #0600FF;">If</span> @<span style="color: #FF8000;">error</span> Or $aRet<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span> <span style="color: #FF8000;">Then</span> <span style="color: #FF8000;">Return</span> SetError<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span><span style="color: #000000;">&#41;</span>
        <span style="color: #FF8000;">Return</span> $aRet<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>
EndFunc   ;<span style="color: #008000;">==</span>&gt;_UnhookWinEvent</pre></div></div>

<p>附件下载：<a href='../../wp-content/uploads/2012/03/scan_menu.rar'>scan_menu</a></p>
					<div class="fixed"></div>
				</div>

				<div class="comments comments_single">
					<a href="index.html#respond">发表评论</a>
									</div>

				<!-- related posts START -->
								<!-- related posts END -->
			</div>


<script type="text/javascript" src="../../wp-content/themes/elegant-box/js/comment.js"></script>


	<div class="messagebox">
		<div class="content small">
			本文的评论功能被关闭了.		</div>
	</div>


			

	</div>

	<!-- sidebar START -->
<div id="sidebar">

<!-- Style Switcher START -->
<div class="widget">
	<div id="styleswitcher">
		<span id="style-text">主题风格: </span>
			<span id="style-green" class="color"><a onclick="TSS.setActiveStyleSheet('green');" href="javascript:void(0);" title="将主题风格更换为green"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-purple" class="color"><a onclick="TSS.setActiveStyleSheet('purple');" href="javascript:void(0);" title="将主题风格更换为purple"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-brown" class="color"><a onclick="TSS.setActiveStyleSheet('brown');" href="javascript:void(0);" title="将主题风格更换为brown"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-blue" class="color"><a onclick="TSS.setActiveStyleSheet('blue');" href="javascript:void(0);" title="将主题风格更换为blue"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-white" class="color"><a onclick="TSS.setActiveStyleSheet('white');" href="javascript:void(0);" title="将主题风格更换为white"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
			<span id="style-black" class="color"><a onclick="TSS.setActiveStyleSheet('black');" href="javascript:void(0);" title="将主题风格更换为black"><img src="../../wp-content/themes/elegant-box/images/transparent.gif" alt="" /></a></span>
		<div class="fixed"></div>
	</div>
</div>
<!-- Style Switcher END -->

		<!-- showcase -->
		
		<ul id="widgets">

<li class="widget widget_calendar"><h3>Archives</h3><div id="calendar_wrap"><table id="wp-calendar">
	<caption>2012 年七月</caption>
	<thead>
	<tr>
		<th scope="col" title="星期日">日</th>
		<th scope="col" title="星期一">一</th>
		<th scope="col" title="星期二">二</th>
		<th scope="col" title="星期三">三</th>
		<th scope="col" title="星期四">四</th>
		<th scope="col" title="星期五">五</th>
		<th scope="col" title="星期六">六</th>
	</tr>
	</thead>

	<tfoot>
	<tr>
		<td colspan="3" id="prev"><a href="../date/2012/05/index.html" title="查看 2012 年五月的文章">&laquo; 五</a></td>
		<td class="pad">&nbsp;</td>
		<td colspan="3" id="next" class="pad">&nbsp;</td>
	</tr>
	</tfoot>

	<tbody>
	<tr><td>1</td><td><a href="../date/2012/07/02/index.html" title="六月随笔">2</a></td><td>3</td><td>4</td><td><a href="../date/2012/07/05/index.html" title="ruby Rspec测试框架cheetsheet">5</a></td><td>6</td><td>7</td>
	</tr>
	<tr>
		<td>8</td><td><a href="../date/2012/07/09/index.html" title="linux下STAF执行失败时的处理">9</a></td><td>10</td><td>11</td><td>12</td><td id="today">13</td><td>14</td>
	</tr>
	<tr>
		<td>15</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td>
	</tr>
	<tr>
		<td>22</td><td>23</td><td>24</td><td>25</td><td>26</td><td>27</td><td>28</td>
	</tr>
	<tr>
		<td>29</td><td>30</td><td>31</td>
		<td class="pad" colspan="4">&nbsp;</td>
	</tr>
	</tbody>
	</table></div></li><li class="widget widget_categories"><h3>分类目录</h3>		<ul>
	<li class="cat-item cat-item-7"><a href="../category/c_cplusplus/index.html" title="查看 C/C++ 下的所有文章">C/C++</a>
</li>
	<li class="cat-item cat-item-24"><a href="../category/ios-dev/index.html" title="查看 IOSDev 下的所有文章">IOSDev</a>
</li>
	<li class="cat-item cat-item-23"><a href="../category/java/index.html" title="查看 java 下的所有文章">java</a>
</li>
	<li class="cat-item cat-item-5"><a href="../category/lamp/index.html" title="查看 LAMP 下的所有文章">LAMP</a>
</li>
	<li class="cat-item cat-item-8"><a href="../category/onthego/index.html" title="查看 OnTheGo 下的所有文章">OnTheGo</a>
</li>
	<li class="cat-item cat-item-1"><a href="../category/other/index.html" title="查看 Other 下的所有文章">Other</a>
</li>
	<li class="cat-item cat-item-3"><a href="../category/project/index.html" title="查看 Project 下的所有文章">Project</a>
</li>
	<li class="cat-item cat-item-4"><a href="../category/rubytesting/index.html" title="查看 Ruby&amp;Testing 下的所有文章">Ruby&amp;Testing</a>
</li>
		</ul>
</li><li class="widget widget_text"><h3>Google Ads</h3>			<div class="textwidget"><script type="text/javascript"><!--
google_ad_client = "ca-pub-7220882232307827";
/* left_180x150, 创建于 09-2-19 */
google_ad_slot = "1136501676";
google_ad_width = 180;
google_ad_height = 150;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
		</li><li class="widget widget_tag_cloud"><h3>标签</h3><div class="tagcloud"><a href='../tag/c/index.html' class='tag-link-9' title='4 个话题' style='font-size: 22pt;'>c</a>
<a href='../tag/dailhelper/index.html' class='tag-link-13' title='1 个话题' style='font-size: 8pt;'>dailhelper</a>
<a href='../tag/linux/index.html' class='tag-link-14' title='1 个话题' style='font-size: 8pt;'>linux</a>
<a href='../tag/ls/index.html' class='tag-link-10' title='1 个话题' style='font-size: 8pt;'>ls</a>
<a href='../tag/makefile/index.html' class='tag-link-17' title='1 个话题' style='font-size: 8pt;'>makefile</a>
<a href='../tag/netkeeper/index.html' class='tag-link-16' title='1 个话题' style='font-size: 8pt;'>Netkeeper</a>
<a href='../tag/pcap/index.html' class='tag-link-25' title='1 个话题' style='font-size: 8pt;'>pcap</a>
<a href='../tag/ruby/index.html' class='tag-link-12' title='1 个话题' style='font-size: 8pt;'>ruby</a>
<a href='../tag/slab/index.html' class='tag-link-20' title='1 个话题' style='font-size: 8pt;'>slab</a>
<a href='../tag/wget/index.html' class='tag-link-11' title='1 个话题' style='font-size: 8pt;'>wget</a>
<a href='../tag/系%259F管%2590%2586/index.html' class='tag-link-15' title='1 个话题' style='font-size: 8pt;'>系统管理</a></div>
</li><li class="widget widget_links"><h3>链接表</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://blog.csdn.net/Android_Tutor" rel="colleague" title="Android_Tutor的专栏" target="_blank">Android学习系列</a></li>
<li><a href="http://wpotp.com" rel="me" title="食品找茬网" target="_blank">找茬网</a></li>
<li><a href="http://www.sz95000.com/" title="深圳长途汽车网上订票，官方网站，这次不会忘记了。。。" target="_blank">深圳长途汽车网上订票</a></li>

	</ul>
</li>
<li class="widget widget_meta"><h3>功能</h3>			<ul>
			<li><a href="../../wp-login.php?action=register">注册</a></li>			<li><a href="../../wp-login.php">登录</a></li>
			<li><a href="../../feed/index.html" title="使用 RSS 2.0 订阅本站点内容">文章 <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="../../comments/feed/index.html" title="使用 RSS 订阅本站点的所有文章的近期评论">评论 <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://cn.wordpress.org/" title="基于 WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li>
						</ul>
</li>		</ul>

		<!-- showcase 2 -->
		
</div>
<!-- sidebar END -->

	<div class="fixed"></div>

		<div id="bottom">
			<div class="postnav">
				<span class="alignleft">&laquo; <a href="../231/index.html" rel="prev">Ruby多线程与同时使用autoit和watir处理popup弹框时的关系</a></span>
				<span class="alignright"><a href="../238/index.html" rel="next">ruby调用OLE实现word输出(支持嵌入图片)</a> &raquo;</span>
				<div class="fixed"></div>
			</div>

			<div class="anchor">
				<span><a href="index.html#" onclick="MGJS.goTop();return false;">置顶</a></span>
			</div>
			<div class="fixed"></div>
			</div>
		<div class="fixed"></div>
	</div>
</div>

<!-- footer START -->
<div id="footer">
	<div class="inner">
		<div class="content">
			<p id="about">
				版权所有 &copy; 2008-2012 Only For Sunshine~ | 基于 <a href="http://wordpress.org/">WordPress</a> | 主题由 <a href="http://www.neoease.com/">NeoEase</a> 提供			</p>

			<ul id="admin">
				<li><a href="../../wp-login.php?action=register">注册</a></li>				<li><a href="../../wp-login.php">登录</a></li>
			</ul>

			<div class="fixed"></div>
		</div>
	</div>
</div><!-- footer END --><script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?aa&#038;ver=3.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/wpgroho.js?ver=3.4.1'></script>
	<div style="display:none">
	</div>

	<script src="http://stats.wordpress.com/e-201228.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:1.4.2',blog:'17044931',post:'234'});
	var load_cmc = function(){linktracker_init(17044931,234,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9565349-1']);
  _gaq.push(['_setDomainName', 'imzc.net']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
</body>
</html>
